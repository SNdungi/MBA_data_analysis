{% extends "layout.html" %}

{% block content %}
<div class="container-fluid ">
    <div class="row">
        
        <!-- SIDEBAR: Compact List Group Style -->
        <div class="col-md-3 col-lg-2">
            <div class="card shadow-sm sticky-top" style="top: 4rem;">
                <div class="card-header bg-white fw-bold small text-muted text-uppercase">
                    <i class="fas fa-folder-open me-2"></i>File Manager
                </div>
                
                <div class="list-group list-group-flush">
                    <!-- 1. My Projects -->
                    <a href="{{ url_for('file_mgt.list_projects') }}" 
                       class="list-group-item list-group-item-action d-flex align-items-center py-2 small {% if active_page == 'list' %}active text-white bg-primary border-primary{% else %}text-dark{% endif %}">
                        <i class="fas fa-list-ul fa-fw me-2 {% if active_page != 'list' %}text-muted{% endif %}"></i> 
                        My Projects
                    </a>
                    
                    <!-- 2. New Study -->
                    <a href="{{ url_for('file_mgt.new_project') }}" 
                       class="list-group-item list-group-item-action d-flex align-items-center py-2 small {% if active_page == 'new' %}active text-white bg-primary border-primary{% else %}text-dark{% endif %}">
                        <i class="fas fa-plus-circle fa-fw me-2 {% if active_page != 'new' %}text-muted{% endif %}"></i> 
                        New Study
                    </a>

                    <!-- 3. Project Admin (Contextual) -->
                    <a href="{% if study %}{{ url_for('file_mgt.project_admin', study_id=study.id) }}{% else %}#{% endif %}" 
                       class="list-group-item list-group-item-action d-flex align-items-center py-2 small 
                       {% if active_page == 'admin' %}active text-white bg-primary border-primary{% elif not study %}disabled text-muted bg-light{% else %}text-dark{% endif %}">
                        <i class="fas fa-cog fa-fw me-2 {% if active_page != 'admin' %}text-muted{% endif %}"></i> 
                        Project Admin
                    </a>

                    <!-- 4. Run Simulation (New Tab) -->
                    <a href="{% if study %}{{ url_for('file_mgt.simulation_setup', study_id=study.id) }}{% else %}#{% endif %}" 
                       class="list-group-item list-group-item-action d-flex align-items-center py-2 small 
                       {% if active_page == 'simulation' %}active text-white bg-primary border-primary{% elif not study %}disabled text-muted bg-light{% else %}text-dark{% endif %}">
                        <i class="fas fa-random fa-fw me-2 {% if active_page != 'simulation' %}text-muted{% endif %}"></i> 
                        Run Simulation
                    </a>
                    

                </div>
            </div>
        </div>

        <!-- MAIN CONTENT AREA -->
        <div class="col-md-9 col-lg-10">
            
            <div class="bg-white p-4 border rounded-2 shadow-sm" style="min-height: 80vh;">
                {% block file_content %}{% endblock %}
            </div>
        </div>
        
    </div>
</div>
{% endblock %}