{% extends "layout.html" %}

{% block content %}

<div class="container mt-4 vh-100">

    <div class="row g-4">
        <!-- File Viewer Column -->
        <div class="col-lg-5">
            <div class="d-flex justify-content-between align-items-center mb-3">
                 <h2>Generated Files</h2>
                 <a href="{{ url_for('file_mgt.project_admin', study_id=session.filenames.study_id) }}" class="btn btn-sm btn-outline-secondary">Back to Project</a>
            </div>
           
            <div class="list-group shadow-sm">
                <!-- Original CSV (Uploads Folder) -->
                <span class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <i class="fas fa-file-csv me-2 text-fluid-teal"></i>
                        Original Data<br>
                        <small class="text-muted">{{ session.filenames.original }}</small>
                    </div>
                    <!-- CHANGED LINK -->
                    <a href="{{ url_for('ops.view_file', filename=session.filenames.original, folder='uploads') }}" class="badge bg-secondary rounded-pill text-decoration-none">View Table</a>
                </span>

                <!-- Question Map JSON (Generated Folder) -->
                <span class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <i class="fas fa-project-diagram me-2 text-fluid-teal"></i>
                        Question Map<br>
                        <small class="text-muted">{{ session.filenames.map }}</small>
                    </div>
                    <!-- CHANGED LINK -->
                    <a href="{{ url_for('ops.view_file', filename=session.filenames.map, folder='generated') }}" class="badge bg-secondary rounded-pill text-decoration-none">View JSON</a>
                </span>

                <!-- Simulated CSV (Generated Folder) -->
                <span class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <i class="fas fa-file-invoice me-2 text-fluid-teal"></i>
                        Simulated Data<br>
                        <small class="text-muted">{{ session.filenames.output }}</small>
                    </div>
                    <!-- CHANGED LINK -->
                    <a href="{{ url_for('ops.view_file', filename=session.filenames.output, folder='generated') }}" class="badge bg-secondary rounded-pill text-decoration-none">View Table</a>
                </span>
            </div>
        </div>

        <!-- Graph Viewer Column -->
        <div class="col-lg-7">
            <h2>Comparison Graphs</h2>
            {% if session.get('filenames', {}).get('graphs') %}
                {% for graph in session.filenames.graphs %}
                <div class="card mb-3 shadow-sm">
                    <img src="{{ url_for('static', filename=graph) }}" class="card-img-top" alt="Comparison Graph">
                </div>
                {% endfor %}
            {% else %}
                <div class="alert alert-fluid-info">
                    <strong>No Graphs Generated.</strong><br>
                    <small>Comparison graphs are generated only if numeric columns were selected for simulation.</small>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}